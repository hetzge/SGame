package de.hetzge.sgame.common.activemap;

import java.util.HashSet;
import java.util.Set;

public class ActiveMap {

	private class ActiveNode<TYPE> {

		private final Set<ActiveNode> connectors = new HashSet<>();
		private ActiveNode connectedWith;
		private final TYPE object;

		public ActiveNode(TYPE object) {
			this.object = object;
		}

		public void connectTo(ActiveNode activeNode) {
			if (this.connectedWith != null) {
				this.connectedWith.connectors.remove(this);
			}
			activeNode.connectors.add(this);
			this.connectedWith = activeNode;
		}

		public TYPE getObject() {
			return this.object;
		}

		public Set<TYPE> getObjects() {
			Set<TYPE> result = new HashSet<>();
			for (ActiveNode<TYPE> activeNode : this.connectors) {
				result.add(activeNode.getObject());
			}
			return result;
		}
	}

	private final int widthInTiles;
	private final int heightInTiles;
	private final ActiveNode[][] nodes;

	public ActiveMap(int widthInTiles, int heightInTiles) {
		this.widthInTiles = widthInTiles;
		this.heightInTiles = heightInTiles;

		this.nodes = new ActiveNode[widthInTiles][];

		for (int x = 0; x < widthInTiles; x++) {
			this.nodes[x] = new ActiveNode[heightInTiles];
			for (int y = 0; y < heightInTiles; y++) {
				this.nodes[x][y] = new ActiveNode();
			}
		}
	}

}
