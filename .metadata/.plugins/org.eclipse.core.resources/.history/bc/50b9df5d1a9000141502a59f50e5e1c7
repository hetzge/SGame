package de.hetzge.sgame.entity.module;

import de.hetzge.sgame.common.Orientation;
import de.hetzge.sgame.common.geometry.Dimension;
import de.hetzge.sgame.common.geometry.Position;
import de.hetzge.sgame.common.geometry.Rectangle;
import de.hetzge.sgame.entity.EntityModule;
import de.hetzge.sgame.sync.SyncProperty;

public class PositionAndDimensionModule extends EntityModule {

	private final SyncProperty<Rectangle> dimensionSyncProperty = new SyncProperty<Rectangle>(new Rectangle());

	/*
	 * for reuse to avoid positon object creation
	 */
	private final Position movePosition = new Position();

	public PositionAndDimensionModule(Rectangle rectangle) {
		this.dimensionSyncProperty.setValue(rectangle);
	}

	public PositionAndDimensionModule() {
	}

	public void setPosition(Position position) {
		this.dimensionSyncProperty.getValue().setPosition(position);
		this.dimensionSyncProperty.setChanged();
	}

	public void setDimension(Dimension dimension) {
		this.dimensionSyncProperty.getValue().setDimension(dimension);
		this.dimensionSyncProperty.setChanged();
	}

	public void move(Orientation orientation, float speed) {
		synchronized (movePosition) {
			this.movePosition.setX(speed);
			this.movePosition.setY(speed);
			Position move = this.movePosition.multiply(orientation.orientationFactor);
			this.dimensionSyncProperty.getValue().getPosition().add(move);
		}
	}
}
